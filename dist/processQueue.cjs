"use strict";function e(e,u,n){if(n||2===arguments.length)for(var i,t=0,r=u.length;t<r;t++)!i&&t in u||(i||(i=Array.prototype.slice.call(u,0,t)),i[t]=u[t]);return e.concat(i||Array.prototype.slice.call(u))}"function"==typeof SuppressedError&&SuppressedError;var u=function(u){void 0===u&&(u=!1);var n=this;this._emplace=u,this._queue=[],this._inProcess=new Map,this.isProcessing=function(e){return!!n._inProcess.get(e)},this.queueItem=function(e){if(n.isProcessing(e.id))return!1;var u=n._queue.findIndex((function(u){return u.id===e.id}));return n._emplace?u>=0?(n._queue.splice(u,1,e),!0):(n._queue.push(e),!0):(u>=0&&n._queue.splice(u,1),n._queue.unshift(e),!0)},this.getNextItem=function(){var e=n._queue.shift();return e?(n._inProcess.set(e.id,e),e):null},this.getQueue=function(u){if(void 0===u&&(u=!1),u){n._queue.forEach((function(e){n._inProcess.set(e.id,e)}));var i=e([],n._queue,!0);return n._queue.splice(0,n._queue.length),i}return e([],n._queue,!0)},this.removeFromQueue=function(e){var u=n._queue.findIndex((function(u){return u.id===e}));return-1!==u&&(n._queue.splice(u,1),!0)},this.doneProcessing=function(e){void 0===e?n._inProcess.clear():n._inProcess.delete(e)},this.length=function(e,u){return n._queue.length?void 0!==e&&n._queue.length&&void 0!==n._queue[0][e]&&void 0!==u?n._queue.filter((function(n){return n[e]===u})).length:n._queue.length:0},this.busy=function(){return n._inProcess.size>0},this.processSize=function(){return n._inProcess.size}};module.exports=u;
